<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">

<html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>Secure_Socket.hpp</title><link rel="stylesheet" type="text/css" href="../styles/main.css" /><script type="text/javascript" src="../styles/main.js"></script><script type="text/javascript">NDLoader.LoadJS("Content", "../styles/");</script></head>

<!-- Generated by Natural Docs, version 2.1.1 -->

<!-- saved from url=(0016)http://localhost -->

<body onload="NDLoader.OnLoad('Content');" class="NDPage NDContentPage">

<a name="Information"></a><a name="Topic16"></a><div class="CTopic TGroup LC first">
 <div class="CTitle">Information</div>
</div>

<a name="License"></a><a name="Topic1"></a><div class="CTopic TInformation LC">
 <div class="CTitle">License</div>
 <div class="CBody"><p>This file is part of Secure_Socket <a href="https://github.com/RazviOverflow/SecureSocket" target="_top">https://&#8203;github&#8203;.com&#8203;/RazviOverflow&#8203;/SecureSocket</a>.</p><p>Secure_Socket is free software: you can redistribute it and/or modify it under the terms of the GNU Lesser General Public License as published by the Free Software Foundation, either version 3 of the License, or (at your option) any later version.</p><p>Secure_Socket is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.&nbsp; See the GNU Lesser General Public License for more details.</p><p>You should have received a copy of the GNU Lesser General Public License along with Secure_Socket.&nbsp; If not, see <a href="https://www.gnu.org/licenses/" target="_top">https://&#8203;www&#8203;.gnu&#8203;.org&#8203;/licenses&#8203;/</a>.</p></div>
</div>

<a name="Authors"></a><a name="Topic7"></a><div class="CTopic TInformation LC">
 <div class="CTitle">Authors</div>
 <div class="CBody"><ul><li><p>Razvan Raducu&nbsp; (University of Zaragoza)</p></li><li><p>Ricardo J. Rodriguez&nbsp; (University of Zaragoza)</p></li></ul></div>
</div>

<a name="Code"></a><a name="Topic37"></a><div class="CTopic TInformation LC">
 <div class="CTitle">Code</div>
 <div class="CBody"><p>Secure_Socket's code can be found in <a href="https://github.com/RazviOverflow/SecureSocket" target="_top">its public repository</a></p></div>
</div>

<a name="Constants"></a><a name="Topic9"></a><div class="CTopic TGroup LC">
 <div class="CTitle">Constants</div>
</div>

<a name="SERVER_SECURE_SOCKET"></a><a name="Topic10"></a><div class="CTopic TConstant LC">
 <div class="CTitle">SERVER_SECURE_SOCKET</div>
 <div class="CBody"><p>Global constant representing the server secure socket type. It is equal to 0.</p></div>
</div>

<a name="CLIENT_SECURE_SOCKET"></a><a name="Topic11"></a><div class="CTopic TConstant LC">
 <div class="CTitle">CLIENT_SECURE_SOCKET</div>
 <div class="CBody"><p>Global constant representing the client secure socket type. It is equal to 1.</p></div>
</div>

<a name="INT_SIZE"></a><a name="Topic26"></a><div class="CTopic TConstant LC">
 <div class="CTitle">INT_SIZE</div>
 <div class="CBody"><p>Global constant defining a fixed size for the int type. It is equal to sizeof(int32_t) (that is, 4).</p></div>
</div>

<a name="Secure_Socket"></a><a name="Topic2"></a><div class="CTopic TSection LC">
 <div class="CTitle">Secure_Socket</div>
 <div class="CBody"><p>Class used to create, use, manage and close the secure socket. The secure channel (hybrid encryption) is created automatically. Once the socket is created, the communication can be carried on and the bytes sent will be automatically encrypted while the bytes received will be automatically decrypted.</p></div>
</div>

<a name="Functions"></a><a name="Topic38"></a><div class="CTopic TGroup LC">
 <div class="CTitle">Functions</div>
</div>

<a name="Secure_Socket(2)"></a><a name="Topic21"></a><div class="CTopic TFunction LC">
 <div class="CTitle">Secure_Socket</div>
 <div id="NDPrototype21" class="NDPrototype WideForm"><div class="PSection PParameterSection CStyle"><table><tr><td class="PBeforeParameters">Secure_Socket(</td><td class="PParametersParentCell"><table class="PParameters"><tr><td class="first"></td><td class="PType"><span class="SHKeyword">int</span>&nbsp;</td><td class="PName">port,</td><td></td><td class="last"></td></tr><tr><td class="PModifierQualifier first">std::</td><td class="PType"><span class="SHKeyword">string</span>&nbsp;</td><td class="PName">IP,</td><td></td><td class="last"></td></tr><tr><td class="first"></td><td class="PType"><span class="SHKeyword">int</span>&nbsp;</td><td class="PName">socket_type</td><td class="PDefaultValueSeparator">&nbsp;=&nbsp;</td><td class="PDefaultValue last">SERVER_SECURE_SOCKET,</td></tr><tr><td class="PModifierQualifier first"><span class="SHKeyword">unsigned</span>&nbsp;</td><td class="PType"><span class="SHKeyword">char</span>*&nbsp;</td><td class="PName">IV</td><td class="PDefaultValueSeparator">&nbsp;=&nbsp;</td><td class="PDefaultValue last">NULL,</td></tr><tr><td class="PModifierQualifier first">std::</td><td class="PType"><span class="SHKeyword">string</span>&nbsp;</td><td class="PName">RSA_private_key_path</td><td class="PDefaultValueSeparator">&nbsp;=&nbsp;</td><td class="PDefaultValue last"><span class="SHString">&quot;&quot;</span>,</td></tr><tr><td class="PModifierQualifier first">std::</td><td class="PType"><span class="SHKeyword">string</span>&nbsp;</td><td class="PName">RSA_public_key_path</td><td class="PDefaultValueSeparator">&nbsp;=&nbsp;</td><td class="PDefaultValue last"><span class="SHString">&quot;&quot;</span>,</td></tr><tr><td class="first"></td><td class="PType"><span class="SHKeyword">int</span>&nbsp;</td><td class="PName">key_len</td><td class="PDefaultValueSeparator">&nbsp;=&nbsp;</td><td class="PDefaultValue last"><span class="SHNumber">32</span></td></tr></table></td><td class="PAfterParameters">)</td></tr></table></div></div>
 <div class="CBody"><p>Default constructor to create the Secure_Socket object.</p><div class="CHeading">Parameters</div><table class="CDefinitionList"><tr><td class="CDLEntry">port<div class="CDLParameterType"><span class="SHKeyword">int</span></div></td><td class="CDLDefinition"><p>The port to listen or connect to.</p></td></tr><tr><td class="CDLEntry">IP<div class="CDLParameterType">std::<span class="SHKeyword">string</span></div></td><td class="CDLDefinition"><p>The IP to listen or connect to.</p></td></tr><tr><td class="CDLEntry">socket_type<div class="CDLParameterType"><span class="SHKeyword">int</span></div></td><td class="CDLDefinition"><p>The type (server or client) of socket to create.</p></td></tr><tr><td class="CDLEntry">IV<div class="CDLParameterType"><span class="SHKeyword">unsigned</span> <span class="SHKeyword">char</span>*</div></td><td class="CDLDefinition"><p>The AES Initialization Vector (IV) to use. Default value is NULL.&nbsp; If the IV is NULL, a random one will be generated and used, otherwise the specified one will be used.</p></td></tr><tr><td class="CDLEntry">RSA_private_key_path<div class="CDLParameterType">std::<span class="SHKeyword">string</span></div></td><td class="CDLDefinition"><p>The path of the private RSA key in .PEM format.</p></td></tr><tr><td class="CDLEntry">RSA_public_key_path<div class="CDLParameterType">std::<span class="SHKeyword">string</span></div></td><td class="CDLDefinition"><p>The path of the public RSA key in .PEM format.</p></td></tr><tr><td class="CDLEntry">key_len<div class="CDLParameterType"><span class="SHKeyword">int</span></div></td><td class="CDLDefinition"><p>The length of the AES key. Default value: 32.</p></td></tr></table><div class="CHeading">Returns</div><p>Reference (pointer) to the secure socket object.</p></div>
</div>

<a name="~Secure_Socket"></a><a name="Topic4"></a><div class="CTopic TFunction LC">
 <div class="CTitle">~Secure_Socket</div>
 <div id="NDPrototype4" class="NDPrototype"><div class="PSection PPlainSection">~Secure_Socket()</div></div>
 <div class="CBody"><p>The destructor will clean up (free) all allocated memory and close the socket.</p></div>
</div>

<a name="secure_send"></a><a name="Topic19"></a><div class="CTopic TFunction LC">
 <div class="CTitle">secure_send</div>
 <div id="NDPrototype19" class="NDPrototype WideForm"><div class="PSection PParameterSection CStyle"><table><tr><td class="PBeforeParameters">ssize_t secure_send(</td><td class="PParametersParentCell"><table class="PParameters"><tr><td class="PModifierQualifier first"><span class="SHKeyword">unsigned</span>&nbsp;</td><td class="PType"><span class="SHKeyword">char</span>*&nbsp;</td><td class="PName">buffer,</td><td></td><td class="last"></td></tr><tr><td class="first"></td><td class="PType">size_t&nbsp;</td><td class="PName">len,</td><td></td><td class="last"></td></tr><tr><td class="first"></td><td class="PType"><span class="SHKeyword">int</span>&nbsp;</td><td class="PName">flags</td><td class="PDefaultValueSeparator">&nbsp;=&nbsp;</td><td class="PDefaultValue last"><span class="SHNumber">0</span></td></tr></table></td><td class="PAfterParameters">)</td></tr></table></div></div>
 <div class="CBody"><p>Sends data over the secure socket. Sends <u>len</u> bytes from <u>buffer</u>.&nbsp; Overwrites the contents of <u>buffer</u> with the encrypted bytes.</p><div class="CHeading">Parameters</div><table class="CDefinitionList"><tr><td class="CDLEntry">buffer<div class="CDLParameterType"><span class="SHKeyword">unsigned</span> <span class="SHKeyword">char</span>*</div></td><td class="CDLDefinition"><p>Buffer from which the bytes will be sent. Will be overwritten with the result of the encryption.</p></td></tr><tr><td class="CDLEntry">len<div class="CDLParameterType">size_t</div></td><td class="CDLDefinition"><p>Length of the buffer or number of bytes to send.</p></td></tr><tr><td class="CDLEntry">flags<div class="CDLParameterType"><span class="SHKeyword">int</span></div></td><td class="CDLDefinition"><p>Socket's flags. It is formed by ORing one or more values specified &lt;here https://man7.org/linux/man-pages/man2/recv.2.html&gt;.</p></td></tr></table><div class="CHeading">Returns</div><p>The number of bytes sent.</p></div>
</div>

<a name="secure_recv"></a><a name="Topic27"></a><div class="CTopic TFunction LC">
 <div class="CTitle">secure_recv</div>
 <div id="NDPrototype27" class="NDPrototype WideForm"><div class="PSection PParameterSection CStyle"><table><tr><td class="PBeforeParameters">ssize_t secure_recv(</td><td class="PParametersParentCell"><table class="PParameters"><tr><td class="PModifierQualifier first"><span class="SHKeyword">unsigned</span>&nbsp;</td><td class="PType"><span class="SHKeyword">char</span>*&nbsp;</td><td class="PName">buffer,</td><td></td><td class="last"></td></tr><tr><td class="first"></td><td class="PType">size_t&nbsp;</td><td class="PName">len,</td><td></td><td class="last"></td></tr><tr><td class="first"></td><td class="PType"><span class="SHKeyword">int</span>&nbsp;</td><td class="PName">flags</td><td class="PDefaultValueSeparator">&nbsp;=&nbsp;</td><td class="PDefaultValue last"><span class="SHNumber">0</span></td></tr></table></td><td class="PAfterParameters">)</td></tr></table></div></div>
 <div class="CBody"><p>Receives data from the secure socket. Receives <u>len</u> bytes into <u>buffer</u>.&nbsp; Overwrites the contents of <u>buffer</u> with the decrypted bytes.</p><div class="CHeading">Parameters</div><table class="CDefinitionList"><tr><td class="CDLEntry">buffer<div class="CDLParameterType"><span class="SHKeyword">unsigned</span> <span class="SHKeyword">char</span>*</div></td><td class="CDLDefinition"><p>Buffer where the bytes will be received into. The result of decrypting them will be stored in this buffer.</p></td></tr><tr><td class="CDLEntry">len<div class="CDLParameterType">size_t</div></td><td class="CDLDefinition"><p>Length of the buffer or number of bytes to receive.</p></td></tr><tr><td class="CDLEntry">flags<div class="CDLParameterType"><span class="SHKeyword">int</span></div></td><td class="CDLDefinition"><p>Socket's flags. It is formed by ORing one or more values specified &lt;here https://man7.org/linux/man-pages/man2/recv.2.html&gt;.</p></td></tr></table><div class="CHeading">Returns</div><p>The number of bytes received (before decrypting the message).</p></div>
</div>

<a name="secure_close"></a><a name="Topic8"></a><div class="CTopic TFunction LC">
 <div class="CTitle">secure_close</div>
 <div id="NDPrototype8" class="NDPrototype"><div class="PSection PPlainSection"><span class="SHKeyword">int</span> secure_close()</div></div>
 <div class="CBody"><p>Closes the socket.</p><div class="CHeading">Returns</div><p>Zero on success.&nbsp; On error, -1 is returned, and errno is set to indicate the error.</p></div>
</div>

<a name="is_alive"></a><a name="Topic12"></a><div class="CTopic TFunction LC">
 <div class="CTitle">is_alive</div>
 <div id="NDPrototype12" class="NDPrototype"><div class="PSection PPlainSection"><span class="SHKeyword">bool</span> is_alive()</div></div>
 <div class="CBody"><p>Determines if the connection is still alive.</p><div class="CHeading">Returns</div><p>True if the connection is still alive, otherwise False.</p></div>
</div>

<a name="Private"></a><a name="Topic14"></a><div class="CTopic TSection LC">
 <div class="CTitle">Private</div>
</div>

<a name="Functions(2)"></a><a name="Topic18"></a><div class="CTopic TGroup LC">
 <div class="CTitle">Functions</div>
</div>

<a name="generate_AES_key"></a><a name="Topic39"></a><div class="CTopic TFunction LC">
 <div class="CTitle">generate_AES_key</div>
 <div id="NDPrototype39" class="NDPrototype WideForm"><div class="PSection PParameterSection CStyle"><table><tr><td class="PBeforeParameters">Key generate_AES_key(</td><td class="PParametersParentCell"><table class="PParameters"><tr><td class="PModifierQualifier first"><span class="SHKeyword">unsigned</span>&nbsp;</td><td class="PType"><span class="SHKeyword">char</span>*&nbsp;</td><td class="PName">IV,</td><td></td><td class="last"></td></tr><tr><td class="first"></td><td class="PType"><span class="SHKeyword">int</span>&nbsp;</td><td class="PName">key_len</td><td class="PDefaultValueSeparator">&nbsp;=&nbsp;</td><td class="PDefaultValue last"><span class="SHNumber">32</span></td></tr></table></td><td class="PAfterParameters">)</td></tr></table></div></div>
 <div class="CBody"><p>Generates the AES key object used to secure the communication.</p><div class="CHeading">Parameters</div><table class="CDefinitionList"><tr><td class="CDLEntry">IV<div class="CDLParameterType"><span class="SHKeyword">unsigned</span> <span class="SHKeyword">char</span>*</div></td><td class="CDLDefinition"><p>The Initialization Vector (IV) to use. If none is specified, i.e., it's value is NULL, a random one will be generated.</p></td></tr><tr><td class="CDLEntry">key_len<div class="CDLParameterType"><span class="SHKeyword">int</span></div></td><td class="CDLDefinition"><p>The length of the key, in bytes. Default value: 32.</p></td></tr></table><div class="CHeading">Property</div><p>Private.</p><div class="CHeading">Returns</div><p>Reference (pointer) to the Key object.</p></div>
</div>

<a name="encrypt_AES"></a><a name="Topic40"></a><div class="CTopic TFunction LC">
 <div class="CTitle">encrypt_AES</div>
 <div id="NDPrototype40" class="NDPrototype WideForm"><div class="PSection PParameterSection CStyle"><table><tr><td class="PBeforeParameters">size_t encrypt_AES(</td><td class="PParametersParentCell"><table class="PParameters"><tr><td class="PModifierQualifier first"><span class="SHKeyword">unsigned</span>&nbsp;</td><td class="PType"><span class="SHKeyword">char</span>*&nbsp;</td><td class="PName last">buffer,</td></tr><tr><td class="first"></td><td class="PType">size_t&nbsp;</td><td class="PName last">buffer_len</td></tr></table></td><td class="PAfterParameters">)</td></tr></table></div></div>
 <div class="CBody"><p>Uses the Key object to AES-encrypt the first _buffer_len bytes from <u>buffer</u>. Overwrites the contents of <u>buffer</u> with the encrypted bytes.</p><div class="CHeading">Parameters</div><table class="CDefinitionList"><tr><td class="CDLEntry">buffer<div class="CDLParameterType"><span class="SHKeyword">unsigned</span> <span class="SHKeyword">char</span>*</div></td><td class="CDLDefinition"><p>Buffer of bytes to encrypt. Will be overwritten with the result of the encryption.</p></td></tr><tr><td class="CDLEntry">buffer_len<div class="CDLParameterType">size_t</div></td><td class="CDLDefinition"><p>Length of the buffer, or number of bytes to encrypt.</p></td></tr></table><div class="CHeading">Property</div><p>Private.</p><div class="CHeading">Returns</div><p>The length of the encrypted byte sequence.</p></div>
</div>

<a name="Variables"></a><a name="Topic41"></a><div class="CTopic TGroup LC">
 <div class="CTitle">Variables</div>
</div>

<a name="IP_"></a><a name="Topic42"></a><div class="CTopic TVariable LC">
 <div class="CTitle">IP_</div>
 <div id="NDPrototype42" class="NDPrototype"><div class="PSection PPlainSection">std::<span class="SHKeyword">string</span> IP_</div></div>
 <div class="CBody"><p>The IP to listen or to connect to.</p><div class="CHeading">Property</div><p>Private.</p></div>
</div>

<a name="port_"></a><a name="Topic43"></a><div class="CTopic TVariable LC">
 <div class="CTitle">port_</div>
 <div id="NDPrototype43" class="NDPrototype"><div class="PSection PPlainSection"><span class="SHKeyword">int</span> port_</div></div>
 <div class="CBody"><p>The port to listen or to connect to.</p><div class="CHeading">Property</div><p>Private.</p></div>
</div>

<a name="socket_"></a><a name="Topic44"></a><div class="CTopic TVariable LC">
 <div class="CTitle">socket_</div>
 <div id="NDPrototype44" class="NDPrototype"><div class="PSection PPlainSection"><span class="SHKeyword">int</span> socket_</div></div>
 <div class="CBody"><p>The socket number (file descriptor).</p><div class="CHeading">Property</div><p>Private.</p></div>
</div>

<a name="key_"></a><a name="Topic45"></a><div class="CTopic TVariable LC last">
 <div class="CTitle">key_</div>
 <div id="NDPrototype45" class="NDPrototype"><div class="PSection PPlainSection">Key* key_</div></div>
 <div class="CBody"><p>The AES Key object.</p><div class="CHeading">Property</div><p>Private.</p><div class="CHeading">See Also</div><p><a href="../index.html#File:Key.hpp:Key" target="_top" onmouseover="NDContentPage.OnLinkMouseOver(event,15);" onmouseout="NDContentPage.OnLinkMouseOut(event);" >Key</a></p></div>
</div>

</body></html>